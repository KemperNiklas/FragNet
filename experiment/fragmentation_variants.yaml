seml:
  executable: experiment_fragmentation.py
  name: fragmentation_variants
  output_dir: experiment/logs/fragmentation_variants
  project_root_dir: ~/substructure-gnns
#  description: A first test.

slurm:
  experiments_per_job: 1
  max_simultaneous_jobs: 4  # Restrict number of simultaneously running jobs per job array
  sbatch_options:
    gres: gpu:1       # num GPUs
    #mem: 16G          # memory
    mem: 32G          # memory
    #cpus-per-task: 4  # num cores
    cpus-per-task: 4  # num cores
    #time: 0-00:55     # max time, D-HH:MM
    time: 0-17:00

###### BEGIN PARAMETER CONFIGURATION ######

fixed:
  project_name: "fragmentation variants"
  trainer_params:
    max_epochs: 202
    testing: False
    min_lr: 1e-5

  data:
    seed: 40
    loader_params:
      batch_size: 128
      num_workers: 4
    dataset: "ZINC"
    one_hot_edge_features: False
    one_hot_node_features: False
    
  model:
    model_type: "HimpNet"
    classification: False
    model_params:
      hidden_channels: 128
      dropout: 0
      num_layers: 3
      inter_message_passing: True
      higher_message_passing: True
      encoding_size_scaling: True
      degree_scaling: True
      low_high_edges: False
      fragment_specific: True
      #reduction: "sum"
      #concat: False


  optimization:
    optimization_params:
      lr: 0.001
      weight_decay: 5e-4
    loss: "mae"
    scheduler_parameters:
      mode: "min"
      factor: 0.5
      patience: 10

grid:
  data.fragmentation_method:
    type: choice
    options:
      #- []
      #- ["BBB", "fragment", 100]
      #- ["BRICS", "fragment", 100]
      #- ["PSM", "fragment", 100]
      - ["Rings", "higher_level_graph_tree", {"vocab_size": 20}]
      # - ["RingsPaths", "higher_level_graph_tree", {"vocab_size": 30, "max_ring": 15}]
      # - ["RingsEdges", "higher_level_graph_tree", {"vocab_size": 20}]
      - ["RingsPaths", "higher_level_graph_tree", {"vocab_size": 30, "max_ring": 15}]
      # - ["RingsEdges", "higher_level_graph_node", {"vocab_size": 20}]
      # - ["Magnet", "higher_level_graph_tree", {"vocab_size": 100}] 

  model.model_params.inter_message_params:
    type: choice
    options:
      #- {"num_layers": 2}
      #- {"transform_scatter": True}
      #- {"reduction": "sum"}
      - {"transform_scatter": True, "num_layers": 2}
  
  model.model_params.graph_rep:
    type: choice
    options:
      - True
      - False
    zip_id: graph_rep
  
  model.model_params.graph_rep_node:
    type: choice
    options:
      - True
      - False
    zip_id: graph_rep


ZINC_full:
  fixed:
    project_name: "fragmentation variants, full dataset"
    data.dataset: "ZINC-full"


# node_feature_comparison:
#   fixed:
#     data.fragmentation_method: ["Magnet", "node_feature", 100]
#     model.model_params.inter_message_passing: False



  

  
